\documentclass[a4paper, 12pt, twoside]{article}
%=========================================CÁC GÓI VÀ HÀM CHUẨN BỊ==========================================
% Cho phép sử dụng màu và vẽ viền
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{contour}
\usepackage{gradient-text}

\definecolor{vol}{HTML}{646464}
\definecolor{eptype}{HTML}{2f5496}      
\definecolor{epnum}{HTML}{4472c4}       
\definecolor{epattr}{HTML}{b4c6e7}

\definecolor{song}{HTML}{7030a0}
\definecolor{ai}{RGB}{91,155,213}
\definecolor{manzai}{HTML}{005900}
\definecolor{bdaya}{HTML}{E31BAF}
\definecolor{bdayb}{HTML}{FFC000}

\definecolor{holofes}{HTML}{ffc000}
\definecolor{holop}{HTML}{9E0000}

% Màu nhân vật
% \definecolor{Suichan}{HTML}{9CD1F8}
\definecolor{Robopon}{RGB}{255,98,98}
\definecolor{Mikopi}{RGB}{254,212,212}
\definecolor{Polmao}{HTML}{fe0f80}
\definecolor{Wamy}{HTML}{a0f9fe}
\definecolor{Shishiron}{HTML}{a2e4ce}

% Công thức toán học
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{unicode-math}
\usepackage{gensymb}
\usepackage{booktabs}
% Hộp văn bản
\usepackage{tcolorbox}
\usepackage{soul}

% Liên kết
\usepackage{hyperref}
\usepackage{fixfoot}

% Chèn các file nhỏ
\usepackage{subfiles}

% Chèn ảnh, video và GIF
\usepackage{graphicx}
% \usepackage{wrapfig}
% \input{media_embed.tex}	
% \usepackage{animate}

% Lề và cỡ chữ tiêu chuẩn
\usepackage{extsizes}                       % Cho cỡ chữ 14pt
\usepackage{geometry}
\geometry{
  top=1cm,
  bottom=1cm,
  left=1cm,
  right=1cm,
  includeheadfoot
}        % Căn chỉnh lề giấy
\usepackage{parskip}
\usepackage{emptypage}
\usepackage{ocgx2}
% Gạch chân xuống dòng
\usepackage{ulem}

% Thay đổi thiết lập chú thích
\usepackage{caption}
\usepackage{subcaption}
\makeatletter
\renewcommand{\fnum@figure}{\textbf{Hình \thefigure}}
\makeatother

\makeatletter
\renewcommand{\fnum@table}{\textbf{Bảng \thefigure}}
\makeatother

\captionsetup{justification= centering, font=footnotesize}

% Sử dụng để thay đổi font
\usepackage{fontspec}
% \usepackage{luatexja}
% \usepackage{luatexja-fontspec}

% Viết furigana
\usepackage{ruby}
\renewcommand{\rubysize}{0.4}
\renewcommand{\rubysep}{1pt}

% Phông cho tên-số các tập
\newfontface\flaregothic[Path=Fontface/]{flaregothicbold.ttf}
\newfontface\cafeteria[Path=Fontface/]{Cafeteria Bold.otf}
\newfontface\fotskip[Path=Fontface/]{FOT-Skip Std B.otf}
\newfontface\vnmsans[Path=Fontface/]{VNM Sans Std.otf}
\newfontface\vnmdisp[Path=Fontface/]{VNM Sans Display Bold.otf}
\newfontface\sen[Path=Fontface/]{Sen-Bold.ttf}
\newfontface\continuum[Path=Fontface/]{contb.ttf}
\newfontface\japfont[Path=Fontface/]{msgothic.ttc}
\newfontface\jiga[Path=Fontface/]{Jigmo.ttf}
\newfontface\jigb[Path=Fontface/]{Jigmo3.ttf}
\newfontface\jigc[Path=Fontface/]{Jigmo3.ttf}
\newfontface\quincy[Path=Fontface/]{Quincy Caps Regular.ttf}

% Phông cho tiêu đề cuốn truyện và đầu-chân trang
\newfontface\frank[Path=Fontface/]{Franklin Gothic Heavy Regular.ttf}
\newfontface\caviar[Path=Fontface/]{VNF-Cariar Dreams Regular.ttf}
\newfontface\hbrk[Path=Fontface/]{HouseBrokenRough.ttf}
\newfontface\ab[Path=Fontface/]{angrybirds-regular.ttf}
\newfontface\abv[Path=Fontface/]{0259-LNTH-angrybirds-regular.ttf}
\newfontface\device[Path=Fontface/]{Device Regular.ttf}
\newfontface\harosbaelz[Path=Fontface/]{BAEFONT_NORMAL-REGULAR_V1.TTF}
\newfontface\brian[Path=Fontface/]{Brianne_s_hand.ttf}
\newfontface\nexa[Path=Fontface/]{Nexa-Heavy.ttf}
\newfontface\digi[Path=Fontface/]{DS-DIGI.TTF}
\newfontface\freshbot[Path=Fontface/]{FRESHBOT.TTF}

% Đặt font chính và font tiếng Nhật
\setmainfont{Times New Roman}
\setmathfont
[    Extension = .otf,
     BoldFont = XITSMath-Bold,
]
{XITSMath-Regular}

% Điểu chỉnh đầu trang và chân trang
\usepackage{fancyhdr}
\usepackage{spverbatim}

% Dùng cho điều chỉnh kích thước và vị trí bảng
\usepackage{array}
\usepackage{changepage}

% Nhóm cột
\usepackage{multirow}
\usepackage{float}
\usepackage{multicol}

% Dùng cho đoạn hội thoại
\usepackage{setspace} % Chia khoảng cách
\usepackage{dialogue}
\usepackage{calc} % Thiết lập khoảng cách giữa tên nhân vật và văn bản
\usetikzlibrary{calc}

%==================================================MACRO===================================================
% A. Đường thẳng, ký hiệu
\newcommand{\ct}
{\begin{center}[---]\end{center}} 		  	                          % Cắt cảnh dài
\newcommand{\chrint}        
{\begin{center}||---||\end{center}}						        	            % Cắt đến giói thiệu nhân vật, có thể bỏ qua
\newcommand{\pov}[1]
{\begin{center}$\langle${#1}$\rangle$\end{center}}			            % Đổi góc nhìn nhân vật (mặc định là ngôi thứ ba)
\newcommand{\il}{\noindent\makebox[\textwidth]
{\rule{\paperwidth}{0.4pt}}}					  			                      % Đường thẳng phân chia

% B. Chèn ảnh và gif
\newcommand{\img}[2][12.5cm]{%
    \begin{figure}[H]
        \centering
        \includegraphics[width=#1]{Image/#2.png}                    % Tự động thêm "Image/" vào trước tên tệp; chỉ cần chèn tên tệp
    \end{figure}
}

\newcommand{\gif}[4][12.5cm]{%
    \begin{figure}[H]
        \centering
        \animategraphics[autoplay,loop,width=#1]
        {30}{Image/#2/#2.}{#3}{#4}                                  % Chỉ cần chèn tên tệp, lấy từ khung #3 tới #4
    \end{figure}
}

\newcommand{\pictdum}{										                          % Ảnh chèn vào thay thế ảnh gif để canh dòng
        \includegraphics[width=8cm]{placeholder.png}
}
    
\newcommand{\vid}[3][12.5cm]{%
  \embedvideo{\includegraphics[width=#1]{Image/#2.png}}{#3.mp4}
}

% C. Viết cụm và định dạng
\newcommand{\omk}{\begin{center}{\abv\Large Truyện phụ}\end{center}}
\newcommand{\anni}{\color{bdaya}A\color{bdayb}N\color{bdaya}N\color{bdayb}I\color{bdaya}V\color{bdayb}E\color{bdaya}R\color{bdayb}S\color{bdaya}A\color{bdayb}I\color{bdaya}R\color{bdayb}E}
\newcommand{\xmas}{\color{green}N\color{gray}O\color{red}Ë\color{green}L}
\newcommand{\hlw}{\color{purple}H\color{brown}A\color{purple}L\color{brown}L\color{purple}O\color{brown}W\color{purple}E\color{brown}E\color{purple}N}
\newcommand{\trva}{\begin{center}{\abv\Large Bạn có biết?}\end{center}}
\newcommand{\hll}{\textit{hololive}}
\newcommand{\stpt}[1]{\begin{center}{\sen\Large {#1}} \end{center}}     % Subsection
\newcommand{\stcap}[1]{\begin{center}{\caviar {#1}} \end{center}}       % Phụ đề cho subsection
\newcommand{\xdo}{\\[-24pt]}                                            % Dùng cho phần dialogue

% D. Bảng xếp hàng (cho các tập Top 10)
\newcommand{\topten}{\ruby{大}{だい}\ruby{惨}{さん}\ruby{事}{じ}}
\newcommand{\bxh}[4]{
    \begin{center}
        {{\cafeteria\Large Number #1:} \\
        {\textbf{#2}} \\
        {(Từ {\flaregothic\textbf{ÉPISODE #3}}, quyển số #4.)}}
    \end{center}
}

% E. Ngôn ngữ
\newcommand{\vie}[1]{\color{red} #1 \color{black}}        % Tiếng Việt (Etsunan ở Round 1 và 2)
\newcommand{\eng}[1]{\color{blue} #1 \color{black}}       % Tiếng Anh
\newcommand{\ind}[1]{\color{green} #1 \color{black}}      % Tiếng Indonesia
\newcommand{\chn}[1]{\color{orange} #1 \color{black}}     % Tiếng Trung

% Thiết đặt môi trường cho đoạn hội thoại
% A. Dùng để viết hoa chữ đầu tiên tên nhân vật
\renewcommand*\DialogueLabel[1]{%
  {#1}:%
}

% B. Thiết lập với độ dài tên dài nhất. Mặc định chọn Hanamaru từ Love Live!.
\newlength{\widestname}
\setlength{\widestname}{2.5cm}

% C. Tái định nghĩa lại hàm dialogue
\makeatletter
\renewenvironment{dialogue} {%
    \begin{list}{} {%
        \setlength\itemsep{\z@ \@plus .5ex}%
        \setlength{\parsep}{\parskip}%
        \setlength{\rightmargin}{0pt}           % Không căn lề phải
        \setlength{\labelwidth}{\widestname}    % Thiết đặt khoảng cách với tên dài nhất
        \setlength{\labelsep}{0.5em}            % Thiết đặt khoảng cách giữa tên nhân vật và đoạn hội thoại
        \setlength{\leftmargin}{\labelwidth}    % Căn lề trái
        \addtolength{\leftmargin}{\labelsep}    % 
        \defcommand\speak [1] {\item[{##1}]}    % Thiết lập lệnh speak trong dialogue
        \let\makelabel\DialogueLabel
      }%
      \PreDialogue\relax
    }{%
  \end{list}%
  }
\makeatother

% D. Hướng mũi tên
\newcommand{\arrow}[1][-45]
      {\begin{tikzpicture}[baseline = -0.5ex]
          \node[inner sep=0pt,outer sep=0pt,rotate = #1] (a) at (0,0)  {\rightarrow};
       \end{tikzpicture}}

% E. Chiêu mộ toàn bộ ký tự
\makeatletter
\font\SOUL@tt="Times New Roman"
\setbox\z@\hbox{\SOUL@tt-}
\SOUL@ttwidth\wd\z@ %reset default width of -
\makeatother

% F. Tabbing
\newcommand\tabs[1][1cm]{\hspace*{#1}}

%================ĐẦU TRANG VÀ CHÂN TRANG====================
\pagestyle{fancy}
\fancyhead{} 
% Tên cuốn truyện
\fancyhead[LO, RE]
{\vnmsans\fontsize{12pt}{12pt}\selectfont
\color{vol}{Xử lý ngôn ngữ tự nhiên}
\\[-12pt]}                                         
% Số chương
% \fancyhead[RO]
% {\harosbaelz\fontsize{18pt}{18pt}\selectfont
% \color{vol}{seven}
% \ab\fontsize{18pt}{18pt}\selectfont
% \color{vol}{\textbf{(VII)}}
% \\[-18pt]
% }
% \fancyhead[LE]
% {\harosbaelz\fontsize{18pt}{18pt}\selectfont
% \color{vol}{\textbf{sept}}
% \ab\fontsize{18pt}{18pt}\selectfont
% \color{vol}{\textbf{(7)}}
% \\[-18pt]}
% Chân trang
% \fancyfoot{} 
% \fancyfoot[CO, CE]{\thepage}
% \fancyfoot[LO]
% {\ab\fontsize{10pt}{10pt}\selectfont \color{vol} [DIGITAL FORMAT ONLY ⇒ DO NOT PRINT]}
% \fancyfoot[RE]
% {\ab\fontsize{10pt}{10pt}\selectfont \color{vol} [FORMAT NUMÉRIQUE UNIQUEMENT ⇒ NE PAS IMPRIMER]}
%==========================================PHẦN THÂN==========================================
\begin{document}
\subfile{Cover} % Phần bìa

\renewcommand{\contentsname}
{\centering\vnmsans\Large\textcolor{vol}{Mục lục}}
{
  \hypersetup{linkcolor=black}
  \tableofcontents
}
%========================================LỜI NÓI ĐẦU==========================================
\newpage
\section*{\phantomsection\label{preface}} 
\addcontentsline{toc}{section}{\textbf{Lời nói đầu}} 
{\centering\vnmsans\Large\textcolor{vol}{Lời nói đầu}\par}
\subfile{intro}

%========================================PHẦN CHÍNH===========================================

\newpage
\section*{\phantomsection\label{epNLP.1}} 
\addcontentsline{toc}{section}{\textbf{Chương I: Giới thiệu}} 
{\centering\vnmsans\Huge\textcolor{vol}{Chương I: Giới thiệu}\par}
\subfile{Episode/Introduction}

\newpage
\section*{\phantomsection\label{epNLP.2}} 
\addcontentsline{toc}{section}{\textbf{Chương II: Cơ sở lý thuyết}}
{\centering\vnmsans\Huge\textcolor{vol}{Chương II: Cơ sở lý thuyết}\par}
\subfile{Episode/Theorem}

\newpage
\section*{\phantomsection\label{epNLP.3}} 
\addcontentsline{toc}{section}{\textbf{Chương III: Xây dựng hệ thống}}
{\centering\vnmsans\Huge\textcolor{vol}{Chương III: Xây dựng hệ thống}\par}
\subfile{Episode/System}

\newpage
\section*{\phantomsection\label{epNLP.4}} 
\addcontentsline{toc}{section}{\textbf{Chương IV: Kết luận}}
{\centering\vnmsans\Huge\textcolor{vol}{Chương IV: Kết luận}\par}
\subfile{Episode/Final}

%==========================================LỜI KẾT============================================
\newpage
% \section*{\phantomsection\label{end}} 
% \addcontentsline{toc}{section}{\textbf{Lời kết}}
% {\centering\vnmsans\Large\textcolor{vol}{Lời kết}\par}
% \subfile{end}

\end{document}